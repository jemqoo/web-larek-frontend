# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:

- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:

- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск

Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```

## Сборка

```
npm run build
```

или

```
yarn build
```

### Базовый код сотоит из Api, Component, EventEmitter, Model

1. Класс Api элемент для взаимодействия с внешними API:
   возможность отправлять GET и POST-запросы;

2. Класс EventEmitter - Брокер событий который имеет возможность:
   "on" - Установить обработчик на событие;
   "off" - Снять обработчик с события;
   "emit" - Инициировать событие с данными;
   "onAll" - Слушать все события;
   "offAll" - Сбросить все обработчики;
   "trigger" - Сделать коллбек триггер, генерирующий событие при вызове;

3. Класс Component - базовый для других компонетов имеет возможность:
   "toggleClass" - Переключить класс;
   "setText" - Установить текстовое содержимое;
   "setDisabled" - Сменить статус блокировки;
   "setHidden/setVisible" - Скрыть/Показать елемент;
   "setImage" - Установить изображение с алтернативным текстом;
   "render" - Вернуть корневой DOM-элемент;

4. Класс Model - абстрактный базовый класс для всех моделей данных в проекте. Он предоставляет универсальную структуру для управления данными и их взаимодействием с системой событий.
   "emitChanges" - сообщает всем что модель поменялась;


### Интерфейсы

// интерфейс, описывающий карточку товара
export interface ILotItem {
id: string;
title: string;
category: string;
description?: string;
image: string;
price: string | number;
}

// интерфейс модели приложения
export interface IAppState {
catalog: ILotItem[];
basket: string[];
order: IOrder | null;
}

// Интерфейс для формы заказа
export interface IOrderForm {
payment: string;
email: string;
phone: string;
address: string;
total: number;
items: string[];
}

// Интерфейс для контактной формы
export interface IContactForm {
email: string;
phone: string;
}

//Интерфейс для формы
export interface IOrder extends IOrderForm {
total: number;
items: string[];
}

### Cписок основных событий:

Изначально с сервера получаем данные о карточках. После этого происходит событие "items:changed", и карточки отображаются на странице.

При клике на карточку, срабатывают события "card:select" и "preview:changed", и открывается модальное окно с подробной информацией о карточке (событие "modal:open").

При нажатии кнопки "в корзину" в открытом модальном окне карточки, происходит добавление этой карточки в поле "basket" класса "AppData" (событие "basket:add" и "basket:changed"), а затем модальное окно закрывается (событие "modal:close").

При нажатии на иконку корзины в верхнем правом углу страницы, срабатывают события "basket:changed" и "basket:open", и открывается модальное окно корзины (событие "modal:open").

При нажатии на иконку удаления карточки в модальном окне корзины, срабатывают события "basket:remove" и "basket:changed", и карточка удаляется из корзины.

При нажатии кнопки "Оформить" в открытом модальном окне корзины, срабатывают события "order:open" и "formErrors:change", и открывается модальное окно "Order" (событие "modal:open").

При выборе способа оплаты через кнопки "Отлайн" и "При получении" в модальном окне "Order", срабатывает событие "order:changed", и данные формы обновляются.

При вводе адреса доставки в поле "address" в модальном окне "Order", срабатывают события "order:changed", "order.address:change" и "formErrors:change", и происходит проверка на валидность поля ввода.

При правильном заполнении способа оплаты и адреса доставки, срабатывает событие "order:ready", и кнопка "Далее" становится активной.

При нажатии кнопки "Далее", срабатывают события "order:submit" и "formErrors:change", и открывается модальное окно "Contacts".

При вводе электронной почты в поле "email" в модальном окне "Contacts", срабатывают события "contacts:changed", "contacts.email:change" и "formErrors:change", и происходит обновление данных формы и проверка на валидность.

При вводе номера телефона в поле "phone" в модальном окне "Contacts", срабатывают события "contacts:changed", "contacts.phone:change" и "formErrors:change", и происходит проверка на валидность поля ввода.

При правильном заполнении электронной почты и телефона, срабатывает событие "contacts:changed", и кнопка "Оплатить" становится активной.

При нажатии кнопки "Оплатить", срабатывает событие "contacts:submit", и открывается модальное окно с подтверждением покупки (событие "modal:open").
